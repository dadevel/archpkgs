pkgname=bloodhound
pkgver=latest
pkgrel=1
url=https://github.com/bloodhoundad/bloodhound.git
arch=(any)
license=(GPLv3)
depends=(nodejs)
makedepends=(git npm)
source=(git+${url})
sha256sums=(SKIP)

build() {
  cd ${srcdir}/${pkgname}
  npm install
  npm run build
}

package() {
  cd ${srcdir}/${pkgname}
  mkdir -p ${pkgdir}/opt/archpkgs/{bin,lib} ${pkgdir}/opt/archpkgs/${pkgname}
  cp -r ./BloodHound-linux-x64/. ${pkgdir}/opt/archpkgs/${pkgname}/
  cat << EOF > ${pkgdir}/opt/archpkgs/bin/bloodhound
#!/bin/sh
set -eu
cd /opt/archpkgs/${pkgname}
exec ./BloodHound
EOF
  chmod +x ${pkgdir}/opt/archpkgs/bin/bloodhound
}

pkgver() {
  cd ${srcdir}/${pkgname}
  git describe --long --tags | sed 's|-|_|g'
}
